üìã –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –±—É–¥—É—â–∏—Ö —Å–µ—Å—Å–∏–π
–°–æ—Ö—Ä–∞–Ω–∏ —ç—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç –∏ –ø—Ä–∏—Å—ã–ª–∞–π –º–Ω–µ –∫–æ–≥–¥–∞ –≤–µ—Ä–Ω–µ—à—å—Å—è:

# Netflix Tinder - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

## üéØ –°—É—Ç—å –ø—Ä–æ–µ–∫—Ç–∞
–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∏–ª—å–º–æ–≤/—Å–µ—Ä–∏–∞–ª–æ–≤ –≤–¥–≤–æ–µ–º —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∫—É —Å–≤–∞–π–ø–æ–≤ (–∫–∞–∫ Tinder).

**Flow:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∫–æ–º–Ω–∞—Ç—É ‚Üí –ø–æ–ª—É—á–∞–µ—Ç invite code
2. –í—Ç–æ—Ä–æ–π —á–µ–ª–æ–≤–µ–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –ø–æ –∫–æ–¥—É
3. –ö–∞–∂–¥—ã–π –≤—ã–±–∏—Ä–∞–µ—Ç N —Ñ–∏–ª—å–º–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—á–µ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å
4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ + —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ)
5. –û–±–∞ —Å–≤–∞–π–ø–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (like/skip) —á–µ—Ä–µ–∑ WebSocket
6. –ü—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ (–æ–±–∞ like) ‚Üí MATCH! –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–ª—å–º

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ø—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è)

### Stack:
- **Frontend:** Next.js (React, TypeScript)
- **Backend:** NestJS (Node.js, TypeScript)
- **Database:** PostgreSQL –Ω–∞ Supabase (free tier)
- **Cache/Sessions:** Redis (self-hosted –Ω–∞ VPS)
- **Real-time:** WebSocket (Socket.io)
- **CDN:** Cloudflare (–¥–ª—è –ø–æ—Å—Ç–µ—Ä–æ–≤ —Ñ–∏–ª—å–º–æ–≤)
- **Hosting:** VPS —Å Docker Compose
- **Monorepo:** npm workspaces (–ø—Ä–æ—Å—Ç–æ–π, –±–µ–∑ Turborepo)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
my-app/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/              # Next.js frontend
‚îÇ   ‚îî‚îÄ‚îÄ api/              # NestJS backend
‚îÇ       ‚îî‚îÄ‚îÄ prisma/       # Prisma —Å—Ö–µ–º–∞ –∑–¥–µ—Å—å (–ù–ï –≤ packages)
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îî‚îÄ‚îÄ shared/           # –û–±—â–∏–µ —Ç–∏–ø—ã (DTO, API responses)
‚îú‚îÄ‚îÄ docker-compose.dev.yml   # PostgreSQL + Redis –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ docker-compose.prod.yml  # –í—Å—ë –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
‚îú‚îÄ‚îÄ package.json          # Root —Å workspaces
‚îî‚îÄ‚îÄ .env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–≤ –∫–æ—Ä–Ω–µ)

### –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è (–æ–±—Å—É–∂–¥–∞–ª–∏ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–ª–∏):

1. **–ú–æ–Ω–æ–ª–∏—Ç –Ω–∞ —Å—Ç–∞—Ä—Ç–µ, –ù–ï –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã**
    - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ > 5000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    - –°–µ–π—á–∞—Å –º–æ–¥—É–ª—å–Ω—ã–π –º–æ–Ω–æ–ª–∏—Ç —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º

2. **Prisma –≤ `/apps/api/prisma`, –ù–ï –≤ packages**
    - –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –±—ç–∫–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ë–î
    - –í—ã–Ω–µ—Å–µ–º –≤ packages –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏–º workers/admin-panel

3. **Redis –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω —Å –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è –¥–ª—è:**
    - WebSocket Pub/Sub (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏)
    - –°–µ—Å—Å–∏–∏ –∏ refresh tokens (–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è)
    - –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–Ω–∞—Ç (hot data, TTL 30 –º–∏–Ω—É—Ç)
    - –ù–ï –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–≤–∞–π–ø–∞ (—Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–µ–π –≤ PostgreSQL)

4. **PostgreSQL = source of truth:**
    - –ö–æ–º–Ω–∞—Ç—ã (rooms), –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (users), –º–∞—Ç—á–∏ (room_matches)
    - Room_swipes –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ–º (—Ç–æ–ª—å–∫–æ –≤ Redis –¥–ª—è real-time)
    - –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∫–∞–∫–æ–π —Ñ–∏–ª—å–º –≤—ã–±—Ä–∞–ª–∏)

5. **CDN –∫—Ä–∏—Ç–∏—á–µ–Ω:**
    - –ü–æ—Å—Ç–µ—Ä—ã —Ñ–∏–ª—å–º–æ–≤ —Ç—è–∂–µ–ª—ã–µ (500KB √ó 100 = 50MB –Ω–∞ —Å–µ—Å—Å–∏—é)
    - Cloudflare –±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–∞–µ—Ç 10TB/–º–µ—Å—è—Ü

6. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–µ –≤ Docker):**
    - –¢–æ–ª—å–∫–æ PostgreSQL + Redis –≤ Docker
    - Next.js –∏ NestJS –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–∞—Ç–∏–≤–Ω–æ (–±—ã—Å—Ç—Ä—ã–π hot reload)
    - –ö–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ npm scripts (–Ω–µ make, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows)

7. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
    - Stateless JWT (access token, 15 –º–∏–Ω—É—Ç)
    - Stateful refresh tokens (–≤ Redis, 30 –¥–Ω–µ–π)
    - WebSocket –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT

8. **TMDB API ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è MVP:**
    - –°–µ–π—á–∞—Å –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ .env
    - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∫–∞ –≤–≤–æ–¥—è—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–º
    - –î–æ–±–∞–≤–∏–º –ø–æ–∑–∂–µ –¥–ª—è –ø–æ—Å—Ç–µ—Ä–æ–≤ –∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è

## üóÑÔ∏è –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö (—á–µ—Ä–Ω–æ–≤–∞—è)

### PostgreSQL:
```sql
rooms (id, invite_code, host_id, guest_id, status, preferences_jsonb, match_result_jsonb, expires_at)
users (id, email, password_hash, created_at)
room_matches (room_id, media_id/title, matched_at, swipes_count)
Redis (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):
session:{userId}:{tokenId} ‚Üí refresh token metadata (TTL 30d)
room:{roomId}:state ‚Üí —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–∞–π–ø–æ–≤ (TTL 30min)
room:{roomId}:media_pool ‚Üí —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤ –¥–ª—è —Å–≤–∞–π–ø–∏–Ω–≥–∞ (TTL 30min)
üîÑ Flow –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

POST /auth/login ‚Üí Access JWT + Refresh token
Refresh token ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Redis —Å metadata (IP, user-agent)
Access token ‚Üí short-lived (15 min), –≤ httpOnly cookie
Logout ‚Üí —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ Redis (–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è)

üè† Flow –∫–æ–º–Ω–∞—Ç—ã

POST /rooms ‚Üí —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É (status: WAITING)
POST /rooms/:code/join ‚Üí –≤—Ç–æ—Ä–æ–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è
POST /rooms/:roomId/selections ‚Üí –æ–±–∞ –≤—ã–±–∏—Ä–∞—é—Ç —Ñ–∏–ª—å–º—ã
WebSocket: –æ–±–∞ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ ws://api/rooms/:roomId
Event: swipe ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Redis + –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞—Ç—á
Event: match_found ‚Üí –æ–±–∞ –ø–æ–ª—É—á–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

üöÄ –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞
 Docker Compose –¥–ª—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω
 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–Ω–æ—Ä–µ–ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
 Stack –≤—ã–±—Ä–∞–Ω (NestJS + Next.js)
 Prisma —Å—Ö–µ–º–∞ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
 Auth –º–æ–¥—É–ª—å (JWT + Redis sessions)
 Rooms –º–æ–¥—É–ª—å (CRUD + WebSocket)
 Matching –ª–æ–≥–∏–∫–∞ (real-time —Å–≤–∞–π–ø—ã)

üíª –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
bashnpm run docker:dev      # –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL + Redis
npm run docker:down     # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker
npm run dev             # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë (Docker + Web + API)
npm run dev:web         # –¢–æ–ª—å–∫–æ Next.js
npm run dev:api         # –¢–æ–ª—å–∫–æ NestJS
npm run db:migrate      # –ü—Ä–∏–º–µ–Ω–∏—Ç—å Prisma –º–∏–≥—Ä–∞—Ü–∏–∏
npm run db:studio       # –û—Ç–∫—Ä—ã—Ç—å Prisma Studio
npm run redis:cli       # Redis CLI
üìù –¢–µ–∫—É—â–∏–µ —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

‚úÖ docker-compose.dev.yml (PostgreSQL + Redis + GUI tools)
‚úÖ .env.example (–≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
‚úÖ package.json (root —Å workspaces –∏ npm scripts)
‚úÖ Makefile (–µ—Å—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ Windows)
‚úÖ DOCKER_SETUP.md (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ Docker)

üéì –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

MVP first ‚Äî –Ω–µ –ø–µ—Ä–µ—É—Å–ª–æ–∂–Ω—è—Ç—å –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
PostgreSQL = source of truth, Redis = hot cache
Async –∑–∞–ø–∏—Å—å –≤ –ë–î ‚Äî –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å real-time –æ–ø–µ—Ä–∞—Ü–∏–∏
Optimistic UI updates ‚Äî —Å–≤–∞–π–ø —Ä–∞–±–æ—Ç–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
Type safety ‚Äî TypeScript –≤–µ–∑–¥–µ, shared types –º–µ–∂–¥—É —Ñ—Ä–æ–Ω—Ç–æ–º –∏ –±—ç–∫–æ–º

üîÆ –ß—Ç–æ –æ—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ –ø–æ—Ç–æ–º

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–∫–æ–≥–¥–∞ > 5000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
ML —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ø–æ–∫–∞ random —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏)
–°–ª–æ–∂–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–ø–æ–∫–∞ Google Analytics)
TMDB API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–ø–æ–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥)
Kubernetes (–ø–æ–∫–∞ Docker Compose –Ω–∞ VPS –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)

üêõ –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

‚ùå Make –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows ‚Üí ‚úÖ npm scripts
‚ùå dotenv –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –≤ NestJS ‚Üí ‚úÖ @nestjs/config
‚ùå Prisma –≤ packages –∏–ª–∏ apps? ‚Üí ‚úÖ –≤ apps/api (–ø–æ–∫–∞ –æ–¥–∏–Ω –±—ç–∫–µ–Ω–¥)
